"0","# import the gencodev32_gff_inFile file"
"0","all_gencode_v29 <- rtracklayer::import(input_genome_gff3_file)"
"0","# this file contains more information than we need here"
"0","# subset out only the columns we need"
"0","gene_data <- data.frame(ensembl = all_gencode_v29@elementMetadata$gene_id,"
"0","                        hgnc_symbol = all_gencode_v29@elementMetadata$gene_name,"
"0","                        seqnames = all_gencode_v29@seqnames,"
"0","                        gene_type = all_gencode_v29@elementMetadata$gene_type)"
"0","# we're left with multiple identical rows, keep one each"
"0","gencode_v29_gene_id_symbol_chr_biotype <- gene_data %>%"
"0","  dplyr::distinct(., .keep_all = TRUE)"
"0","# which leaves us with the following dimensions where there is a unique combination of ensembl ID, hgnc symbol and chromosome"
"0","dim(gencode_v29_gene_id_symbol_chr_biotype) # 64837 3"
"1","[1]"
"1"," 64837"
"1","     4"
"1","
"
"0","# this does however, leave us with duplicate ensembl IDs"
"0","dim(gencode_v29_gene_id_symbol_chr_biotype[!duplicated(gencode_v29_gene_id_symbol_chr_biotype$ensembl), ]) # 64792 3"
"1","[1]"
"1"," 64792"
"1","     4"
"1","
"
"0","# after generating a table to see the duplicates I can see that this is an X/Y chromosome issue. All genes are assigned to both chromosomes"
"0","duplicate_rows <- gencode_v29_gene_id_symbol_chr_biotype[duplicated(gencode_v29_gene_id_symbol_chr_biotype$ensembl_gene_id) | duplicated(gencode_v29_gene_id_symbol_chr_biotype$ensembl, fromLast = TRUE),]"
"0","# remove duplicates (we don't use the chromosome information for anything)"
"0","gencode <- gencode_v29_gene_id_symbol_chr_biotype[!duplicated(gencode_v29_gene_id_symbol_chr_biotype$ensembl), ]"
