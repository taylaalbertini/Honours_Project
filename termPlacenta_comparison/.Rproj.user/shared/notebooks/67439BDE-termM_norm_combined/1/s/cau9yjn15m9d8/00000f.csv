"0","if (!require(""BiocManager"", quietly = TRUE))"
"0","  install.packages(""BiocManager"")"
"2","Bioconductor version 3.19 (BiocManager 1.30.23), R 4.4.0 (2024-04-24)
"
"0","deps <- c(""ensembldb"", ""AnnotationHub"")"
"0","sapply(deps, function(x){"
"0","  if (!require(x, quietly = TRUE, character.only = TRUE))"
"0","    BiocManager::install(x)"
"0","})"
"2","
Attaching package: ‘AnnotationFilter’

"
"2","The following object is masked from ‘package:magrittr’:

    not

"
"2","
Attaching package: 'ensembldb'

"
"2","The following object is masked from 'package:dplyr':

    filter

"
"2","The following object is masked from 'package:stats':

    filter

"
"2","Registered S3 methods overwritten by 'dbplyr':
  method         from
  print.tbl_lazy     
  print.tbl_sql      
"
"2","
Attaching package: 'dbplyr'

"
"2","The following objects are masked from 'package:dplyr':

    ident, sql

"
"2","
Attaching package: 'AnnotationHub'

"
"2","The following object is masked from 'package:Biobase':

    cache

"
"1","$ensembldb
"
"1","NULL
"
"1","
"
"1","$AnnotationHub
"
"1","NULL
"
"1","
"
"0","library(ensembldb)"
"0","library(AnnotationHub)"
"0","# lets take a snapshot of the AnnotationHub data base"
"0","ah <- AnnotationHub(ask = FALSE)"
"2","snapshotDate(): 2024-04-29
"
"0","# take a look at the information inside"
"0","mcols(ah)"
"1","DataFrame"
"1",""
"1"," with "
"1",""
"1","71310"
"1",""
"1"," row"
"1",""
"1","s"
"1",""
"1"," and "
"1",""
"1","15"
"1",""
"1"," column"
"1",""
"1","s"
"1",""
"1","
"
"1","        "
"1","                  title"
"1"," dataprovider"
"1","      species"
"1"," taxonomyid"
"1","      genome"
"1","            description"
"1","
        "
"1","            <character>"
"1","  <character>"
"1","  <character>"
"1","  <integer>"
"1"," <character>"
"1","            <character>"
"1","
AH5012  "
"1","        Chromosome Band"
"1","         UCSC"
"1"," Homo sapiens"
"1","       9606"
"1","        hg19"
"1"," GRanges object from .."
"1","
AH5013  "
"1","            STS Markers"
"1","         UCSC"
"1"," Homo sapiens"
"1","       9606"
"1","        hg19"
"1"," GRanges object from .."
"1","
AH5014  "
"1","            FISH Clones"
"1","         UCSC"
"1"," Homo sapiens"
"1","       9606"
"1","        hg19"
"1"," GRanges object from .."
"1","
AH5015  "
"1","            Recomb Rate"
"1","         UCSC"
"1"," Homo sapiens"
"1","       9606"
"1","        hg19"
"1"," GRanges object from .."
"1","
AH5016  "
"1","           ENCODE Pilot"
"1","         UCSC"
"1"," Homo sapiens"
"1","       9606"
"1","        hg19"
"1"," GRanges object from .."
"1","
...     "
"1","                    ..."
"1","          ..."
"1","          ..."
"1","        ..."
"1","         ..."
"1","                    ..."
"1","
AH116727"
"1","    ENCODE_dELS_regions"
"1","       ENCODE"
"1"," Homo sapiens"
"1","       9606"
"1","        hg38"
"1"," A GRanges object con.."
"1","
AH116728"
"1","    ENCODE_pELS_regions"
"1","       ENCODE"
"1"," Homo sapiens"
"1","       9606"
"1","        hg38"
"1"," A GRanges object con.."
"1","
AH116729"
"1","     ENCODE_PLS_regions"
"1","       ENCODE"
"1"," Homo sapiens"
"1","       9606"
"1","        hg38"
"1"," A GRanges object con.."
"1","
AH116730"
"1"," GENCODE basic gene a.."
"1","      GENCODE"
"1"," Homo sapiens"
"1","       9606"
"1","      GRCh38"
"1"," GENCODE comprehensiv.."
"1","
AH116731"
"1"," ENCODE Registry of c.."
"1"," ENCODE cCREs"
"1"," Homo sapiens"
"1","       9606"
"1","      GRCh38"
"1"," ENCODE cCREs V3 all .."
"1","
"
"1","        "
"1"," coordinate_1_based"
"1","             maintainer"
"1"," rdatadateadded"
"1","          preparerclass"
"1","
        "
"1","          <integer>"
"1","            <character>"
"1","    <character>"
"1","            <character>"
"1","
AH5012  "
"1","                  1"
"1"," Marc Carlson <mcarls.."
"1","     2013-03-26"
"1"," UCSCFullTrackImportP.."
"1","
AH5013  "
"1","                  1"
"1"," Marc Carlson <mcarls.."
"1","     2013-03-26"
"1"," UCSCFullTrackImportP.."
"1","
AH5014  "
"1","                  1"
"1"," Marc Carlson <mcarls.."
"1","     2013-03-26"
"1"," UCSCFullTrackImportP.."
"1","
AH5015  "
"1","                  1"
"1"," Marc Carlson <mcarls.."
"1","     2013-03-26"
"1"," UCSCFullTrackImportP.."
"1","
AH5016  "
"1","                  1"
"1"," Marc Carlson <mcarls.."
"1","     2013-03-26"
"1"," UCSCFullTrackImportP.."
"1","
...     "
"1","                ..."
"1","                    ..."
"1","            ..."
"1","                    ..."
"1","
AH116727"
"1","                  1"
"1"," Rhie Lab at the Univ.."
"1","     2024-04-29"
"1","    TENET.AnnotationHub"
"1","
AH116728"
"1","                  1"
"1"," Rhie Lab at the Univ.."
"1","     2024-04-29"
"1","    TENET.AnnotationHub"
"1","
AH116729"
"1","                  1"
"1"," Rhie Lab at the Univ.."
"1","     2024-04-29"
"1","    TENET.AnnotationHub"
"1","
AH116730"
"1","                  1"
"1"," Sara Lopez <lopez_s@.."
"1","     2024-04-29"
"1","       CENTREannotation"
"1","
AH116731"
"1","                  1"
"1"," Sara Lopez <lopez_s@.."
"1","     2024-04-29"
"1","       CENTREannotation"
"1","
"
"1","        "
"1","                                  tags"
"1","       rdataclass"
"1","              rdatapath"
"1","
        "
"1","                                <AsIs>"
"1","      <character>"
"1","            <character>"
"1","
AH5012  "
"1","               cytoBand,UCSC,track,..."
"1","          GRanges"
"1"," goldenpath/hg19/data.."
"1","
AH5013  "
"1","                 stsMap,UCSC,track,..."
"1","          GRanges"
"1"," goldenpath/hg19/data.."
"1","
AH5014  "
"1","             fishClones,UCSC,track,..."
"1","          GRanges"
"1"," goldenpath/hg19/data.."
"1","
AH5015  "
"1","             recombRate,UCSC,track,..."
"1","          GRanges"
"1"," goldenpath/hg19/data.."
"1","
AH5016  "
"1","          encodeRegions,UCSC,track,..."
"1","          GRanges"
"1"," goldenpath/hg19/data.."
"1","
...     "
"1","                                   ..."
"1","              ..."
"1","                    ..."
"1","
AH116727"
"1","   DnaseSeq,ENCODE,GenomicSequence,..."
"1","          GRanges"
"1"," TENET.AnnotationHub/.."
"1","
AH116728"
"1","   DnaseSeq,ENCODE,GenomicSequence,..."
"1","          GRanges"
"1"," TENET.AnnotationHub/.."
"1","
AH116729"
"1","   DnaseSeq,ENCODE,GenomicSequence,..."
"1","          GRanges"
"1"," TENET.AnnotationHub/.."
"1","
AH116730"
"1"," AnnotationData,AnnotationHub,Organism"
"1"," SQLiteConnection"
"1"," gencode_v38.one.tran.."
"1","
AH116731"
"1"," AnnotationData,AnnotationHub,Organism"
"1"," SQLiteConnection"
"1"," ENCODEAnnotation-GRC.."
"1","
"
"1","        "
"1","              sourceurl"
"1","  sourcetype"
"1","
        "
"1","            <character>"
"1"," <character>"
"1","
AH5012  "
"1"," rtracklayer://hgdown.."
"1","  UCSC track"
"1","
AH5013  "
"1"," rtracklayer://hgdown.."
"1","  UCSC track"
"1","
AH5014  "
"1"," rtracklayer://hgdown.."
"1","  UCSC track"
"1","
AH5015  "
"1"," rtracklayer://hgdown.."
"1","  UCSC track"
"1","
AH5016  "
"1"," rtracklayer://hgdown.."
"1","  UCSC track"
"1","
...     "
"1","                    ..."
"1","         ..."
"1","
AH116727"
"1"," https://screen.encod.."
"1","         BED"
"1","
AH116728"
"1"," https://screen.encod.."
"1","         BED"
"1","
AH116729"
"1"," https://screen.encod.."
"1","         BED"
"1","
AH116730"
"1"," https://www.gencodeg.."
"1","         GTF"
"1","
AH116731"
"1"," https://screen.encod.."
"1","         BED"
"1","
"
"0","# use the `query()` function to extract the information for humans"
"0","ensdb_homo <- query(ah, c(""EnsDb"", ""Homo sapiens""))"
"0","# keep only the information for AH95744 (which is the same as your gencode V29)"
"0","ensdb_104 <- ensdb_homo[[""AH95744""]]"
"2","loading from cache
"
"0","# Extract gene-level information and take a look"
"0","genes(ensdb_104, return.type = ""data.frame"") %>% View()"
"0","# now put that gene-level information into a data frame"
"0","genes_info <- genes(ensdb_104, return.type = ""data.frame"")"
"0",""
"0","# left join genes_info with placentaM_depleted_annotated_2"
"0","## change geneid column name to ensembl"
"0","colnames(genes_info) <- gsub(""gene_id"", ""ensembl"", colnames(genes_info)) "
"0","## left join the dfs"
"0","placentaM_depleted_annotated_2 <- dplyr::left_join(placentaM_depleted_annotated_2, genes_info, by = join_by(ensembl))"
"0","## tidy the df"
"0","placentaM_depleted_annotated_2 <- dplyr::select(placentaM_depleted_annotated_2, -11:-17)"
"0","placentaM_depleted_annotated_2 <- dplyr::select(placentaM_depleted_annotated_2, -12:-15)"
