# export heart_m_depleted_DESq in project rawData for further analysis
write.csv(heart_m_depleted_DESq, file = file.path(projectDir, "DESq_lungM_depleted.csv"))
# load relevant libraries
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
# set path for male DESq normalised ncpm counts
import_mean_male_cpms_DESq <- file.path(projectDir, "mean_male_cpms_DESq.csv")
## load mean male DESq normalised CPM data from termPlacenta_comparison analysis
ncpms_male_DESq <- read_delim(file = file.path("/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/readCounts_analysis/rawData/mean_male_cpms_DESq.csv"),
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
# remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# copy mean_cpms for subsequent analysis
ncpms_male_DESq_cp <- as.data.frame(ncpms_male_DESq)
# make calc_rank a function
calculate_rank <- function(x) {
return(rank(-x))
}
# rank normalised cpms by male_tissue
ncpms_male_DESq[, paste0(names(ncpms_male_DESq)[-1], "_Rank")] <- apply(ncpms_male_DESq [, -1, drop = FALSE], 2, calculate_rank)
# create a df consistingof just '_Rank'
## convert sex_tissue from a column to row names
ncpms_male_DESq <- tibble::column_to_rownames(ncpms_male_DESq, var = "sex_tissue")
## create the df filtering just for _Rank
ranked_male_ncpms_DESq <- data.frame(ncpms_male_DESq) %>%
dplyr::select(matches("_Rank"))
# create a rank table
## create a df with 'geneid' in rows and samples in columns
ranked_male_DESq <- t(ranked_male_ncpms_DESq) %>%
## ensure it's in data frame structure
data.frame() %>%
## convert 'geneid' from row names to a column
tibble::rownames_to_column("geneid")
## remove "_Rank" from the end of the geneids
ranked_male_DESq <- tidyr::separate(
ranked_male_DESq,
col = geneid,
into = c("geneid", "right"),
sep = "_Rank") %>%
mutate(geneid = str_remove(geneid, "_Rank")) %>%
dplyr::select(-right)
## rename from sex_tisue to sex_tissue_rank so rank columns can be differentiated from ncpm columns when they are combined
colnames(ranked_male_DESq) <- gsub("male_brain", "male_brain_rank", colnames(ranked_male_DESq))
colnames(ranked_male_DESq) <- gsub("male_heart", "male_heart_rank", colnames(ranked_male_DESq))
colnames(ranked_male_DESq) <- gsub("male_liver", "male_liver_rank", colnames(ranked_male_DESq))
colnames(ranked_male_DESq) <- gsub("male_lung", "male_lung_rank", colnames(ranked_male_DESq))
colnames(ranked_male_DESq) <- gsub("male_muscle", "male_muscle_rank", colnames(ranked_male_DESq))
colnames(ranked_male_DESq) <- gsub("male_placenta.", "male_placenta_rank", colnames(ranked_male_DESq))
# create ncpms table in the same format as rank table so they can be joined
## transpose the data frame, flips rows and columns (rows become columns and columns become rows)
nCPMs_male_DESq <- data.frame(ncpms_male_DESq_cp) %>%
## makes the column sex_tissue row names
tibble::column_to_rownames(., var = "sex_tissue") %>%
t() %>%
data.frame() %>%
## change geneids from row names to a column
tibble::rownames_to_column("geneid")
## rename from sex_tissue to sex_tissue_ncpm so ncpm columns can be differentiated from rank columns once they are joined into one table
colnames(nCPMs_male_DESq) <- gsub("male_brain", "male_brain_ncpm", colnames(nCPMs_male_DESq))
colnames(nCPMs_male_DESq) <- gsub("male_heart", "male_heart_ncpm", colnames(nCPMs_male_DESq))
colnames(nCPMs_male_DESq) <- gsub("male_liver", "male_liver_ncpm", colnames(nCPMs_male_DESq))
colnames(nCPMs_male_DESq) <- gsub("male_lung", "male_lung_ncpm", colnames(nCPMs_male_DESq))
colnames(nCPMs_male_DESq) <- gsub("male_muscle", "male_muscle_ncpm", colnames(nCPMs_male_DESq))
colnames(nCPMs_male_DESq) <- gsub("male_placenta.", "male_placenta_ncpm", colnames(nCPMs_male_DESq))
# combine the rank and ncpm tables via dplyr::left_join
nCPMs_rank_male_DESq <- dplyr::left_join(ranked_male_DESq, nCPMs_male_DESq, copy = TRUE, by = join_by(geneid))
# select for when placenta_rank = 6 (placenta ncpm is ranked last for the given genes)
heart_male_6_DESq <- subset(nCPMs_rank_male_DESq, male_muscle_rank == "6")
View(heart_male_6_DESq)
# filter for where rank = 5 and ncpm > 1
nCPM_rank_5_DESq <- dplyr::filter(heart_male_6_DESq, male_placenta_rank == "5" & male_placenta_ncpm > 1 | male_brain_rank == "5" & male_brain_ncpm > 1 | male_heart_rank == "5" & male_heart_ncpm > 1 | male_liver_rank == "5" & male_liver_ncpm > 1 | male_lung_rank == "5" & male_lung_ncpm > 1)
# separate rank and ncpm into their own tables again to avoid introduction of geneid duplicates when the table is converted to long form. Will need to convert the rank and ncpm tables into long form individually and then join them together for nCPM(rank=5)/nCPM(rank=6) > 3 calculations.
## separate rank into its own table
rank_5_DESq <- tibble::column_to_rownames(nCPM_rank_5_DESq, var = "geneid") %>%
data.frame() %>%
dplyr::select(matches("_rank"))
## separate cpm into its own table
nCPM_5_DESq <- tibble::column_to_rownames(nCPM_rank_5_DESq, var = "geneid") %>%
data.frame() %>%
dplyr::select(matches("_ncpm"))
# convert rank_5_DESq into long form
## convert geneid from row names into a column
rank_5_DESq_long <- tibble::rownames_to_column(rank_5_DESq, var = "geneid")
## remove "_rank" from column names
colnames(rank_5_DESq_long) <- gsub("_rank", "", colnames(rank_5_DESq_long))
## convert into long form
rank_5_DESq_long <- tidyr::gather(rank_5_DESq_long, tissue, rank, male_brain, male_heart, male_liver, male_lung, male_muscle, male_placenta)
## craete a df where tissue rank = 5 to calculate the nCPM(rank=5)/nCPM(rank=6) ratio
rank_5_DESq_long_2 <- dplyr::filter(rank_5_DESq_long, rank == "5")
# convert nCPM_5_DESq into long form
## convert geneid from row names into a column
nCPM_5_DESq_long <- tibble::rownames_to_column(nCPM_5_DESq, var = "geneid")
## remove "_ncpm" from column names
colnames(nCPM_5_DESq_long) <- gsub("_ncpm", "", colnames(nCPM_5_DESq_long))
## convert into long form
nCPM_5_DESq_long <- tidyr::gather(nCPM_5_DESq_long, tissue, ncpm, male_brain, male_heart, male_liver, male_lung, male_muscle, male_placenta)
# join the rank and ncpm long form tables into one containing ncpms where tissue = rank 5
nCPM_rank_5_DESq_long <- dplyr::left_join(rank_5_DESq_long_2, nCPM_5_DESq_long, by = c("geneid", "tissue"))
## rename ncpm to nCPM_5
colnames(nCPM_rank_5_DESq_long) <- gsub("ncpm", "nCPM_5", colnames(nCPM_rank_5_DESq_long))
# create a long df with just the instances where placenta = 6
rank_heart_long <- dplyr::filter(rank_5_DESq_long, rank == "6")
# join nCPM_5_DESq_long to rank_placenta_long to add ncpms for geneids where placenta rank = 6
heart_6_nCPM <- dplyr::left_join(rank_heart_long, nCPM_5_DESq_long, by = c("geneid", "tissue"))
# clean table
## rename ncpms so column names are unique
colnames(heart_6_nCPM) <- gsub("ncpm", "nCPM_6", colnames(heart_6_nCPM))
## remove rank and tissue columns as we only require ncpm(rank=6) for ratio calculation
heart_6_nCPM <- dplyr::select(heart_6_nCPM, -tissue, -rank)
# join heart_6_nCPM and nCPM_rank_5_DESq_long creating a df with both the nCPMs of rank 5 and 6
nCPM5_nCPM6_DESq_male <- dplyr::left_join(nCPM_rank_5_DESq_long, heart_6_nCPM, by = "geneid")
# create a new column for nCPM5/nCPM6
nCPM5_nCPM6_DESq_male$nCPM_ratio <- nCPM5_nCPM6_DESq_male$nCPM_5 / nCPM5_nCPM6_DESq_male$nCPM_6
# select for nCPM_ratio > 3
heart_m_depleted_DESq <- nCPM5_nCPM6_DESq_male[nCPM5_nCPM6_DESq_male$nCPM_ratio >3,]
# replace column name 'geneid' with 'ensembl'
colnames(heart_m_depleted_DESq) <- gsub("geneid", "ensembl", colnames(heart_m_depleted_DESq))
# export heart_m_depleted_DESq in project rawData for further analysis
write.csv(heart_m_depleted_DESq, file = file.path(projectDir, "DESq_muscleM_depleted.csv"))
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
# path for data tables
import_TMM_depletedM <- file.path(projectDir, "TMM_liverM_depleted.csv")
import_DESq_depletedM <- file.path(projectDir, "DESq_liverM_depleted.csv")
# TMM_depletedM
TMM_depletedM <- read_delim(file = import_TMM_depletedM,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
# remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# DESq_depletedM
DESq_depletedM <- read_delim(file = import_DESq_depletedM,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
# remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# filter the df to only including the relevant pieces of information and make specific to normalisation technique
## TMM
## remove rank column
TMM_depletedM <- TMM_depletedM[,-3]
## rename columns to be specific to TMM normalisation
colnames(TMM_depletedM) <- gsub("tissue", "tissue_r5_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_5", "nCPM_5_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_6", "nCPM_liver_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_ratio", "nCPM_ratio_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("geneid", "ensembl", colnames(TMM_depletedM))
## DESq
## remove rank column
DESq_depletedM <- DESq_depletedM[,-3]
## rename columns to be specific to DESq normalisation
colnames(DESq_depletedM) <- gsub("tissue", "tissue_r5_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_5", "nCPM_5_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_6", "nCPM_liver_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_ratio", "nCPM_ratio_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("geneid", "ensembl", colnames(DESq_depletedM))
# test to ensure there are no duplicated ensembl names
sum(duplicated(TMM_depletedM$ensembl))
sum(duplicated(DESq_depletedM$ensembl))
# left join TMM_depletedM to DESq_depletedM
liverM_depleted <- dplyr::inner_join(TMM_depletedM, DESq_depletedM, by = join_by(ensembl))
## export for plots
write.csv(liverM_depleted, file = file.path(projectDir, "liverM_depleted.csv"))
View(liverM_depleted)
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
# path for data tables
import_TMM_depletedM <- file.path(projectDir, "TMM_lungM_depleted.csv")
import_DESq_depletedM <- file.path(projectDir, "DESq_lungM_depleted.csv")
# TMM_depletedM
TMM_depletedM <- read_delim(file = import_TMM_depletedM,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
# remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# DESq_depletedM
DESq_depletedM <- read_delim(file = import_DESq_depletedM,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
# remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# filter the df to only including the relevant pieces of information and make specific to normalisation technique
## TMM
## remove rank column
TMM_depletedM <- TMM_depletedM[,-3]
## rename columns to be specific to TMM normalisation
colnames(TMM_depletedM) <- gsub("tissue", "tissue_r5_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_5", "nCPM_5_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_6", "nCPM_lung_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_ratio", "nCPM_ratio_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("geneid", "ensembl", colnames(TMM_depletedM))
## DESq
## remove rank column
DESq_depletedM <- DESq_depletedM[,-3]
## rename columns to be specific to DESq normalisation
colnames(DESq_depletedM) <- gsub("tissue", "tissue_r5_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_5", "nCPM_5_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_6", "nCPM_lung_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_ratio", "nCPM_ratio_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("geneid", "ensembl", colnames(DESq_depletedM))
# test to ensure there are no duplicated ensembl names
sum(duplicated(TMM_depletedM$ensembl))
sum(duplicated(DESq_depletedM$ensembl))
# left join TMM_depletedM to DESq_depletedM
lungM_depleted <- dplyr::inner_join(TMM_depletedM, DESq_depletedM, by = join_by(ensembl))
## export for plots
write.csv(lungM_depleted, file = file.path(projectDir, "lungM_depleted.csv"))
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
# path for data tables
import_TMM_depletedM <- file.path(projectDir, "TMM_muscleM_depleted.csv")
import_DESq_depletedM <- file.path(projectDir, "DESq_muscleM_depleted.csv")
# TMM_depletedM
TMM_depletedM <- read_delim(file = import_TMM_depletedM,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
# remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# DESq_depletedM
DESq_depletedM <- read_delim(file = import_DESq_depletedM,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
# remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# filter the df to only including the relevant pieces of information and make specific to normalisation technique
## TMM
## remove rank column
TMM_depletedM <- TMM_depletedM[,-3]
## rename columns to be specific to TMM normalisation
colnames(TMM_depletedM) <- gsub("tissue", "tissue_r5_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_5", "nCPM_5_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_6", "nCPM_muscle_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("nCPM_ratio", "nCPM_ratio_TMM", colnames(TMM_depletedM))
colnames(TMM_depletedM) <- gsub("geneid", "ensembl", colnames(TMM_depletedM))
## DESq
## remove rank column
DESq_depletedM <- DESq_depletedM[,-3]
## rename columns to be specific to DESq normalisation
colnames(DESq_depletedM) <- gsub("tissue", "tissue_r5_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_5", "nCPM_5_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_6", "nCPM_muscle_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("nCPM_ratio", "nCPM_ratio_DESq", colnames(DESq_depletedM))
colnames(DESq_depletedM) <- gsub("geneid", "ensembl", colnames(DESq_depletedM))
# test to ensure there are no duplicated ensembl names
sum(duplicated(TMM_depletedM$ensembl))
sum(duplicated(DESq_depletedM$ensembl))
# left join TMM_depletedM to DESq_depletedM
muscleM_depleted <- dplyr::inner_join(TMM_depletedM, DESq_depletedM, by = join_by(ensembl))
## export for plots
write.csv(muscleM_depleted, file = file.path(projectDir, "muscleM_depleted.csv"))
## female depleted transcripts lollipop plots
female_df <- data.frame(
x = c("female_brain", "female_heart", "female_liver", "female_lung", "female_muscle", "female_placenta"),
y = c(443, 19, 444, 75, 32, 208)
)
View(female_df)
## plot
ggplot(female_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y))
library(ggplot2)
## plot
ggplot(female_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y))
female_df <- data.frame(
x = c("female_brain", "female_heart", "female_liver", "female_lung", "female_muscle", "female_placenta"),
y = c(443, 19, 444, 75, 32, 208) %>%
arrange(desc(y))
View(female_df)
female_df <- data.frame(
x = c("female_brain", "female_heart", "female_liver", "female_lung", "female_muscle", "female_placenta"),
y = c(443, 19, 444, 75, 32, 208)
) %>%
arrange(desc(y))
# load relevant libraries
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
## female depleted transcripts lollipop plots
## create a data frame with female_tissue and the corresponding no. of depleted transcripts
female_df <- data.frame(
x = c("female_brain", "female_heart", "female_liver", "female_lung", "female_muscle", "female_placenta"),
y = c(443, 19, 444, 75, 32, 208)
) %>%
arrange(desc(y))
View(female_df)
## plot
ggplot(female_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw()
View(female_df)
ggplot(female_df,
aes(x=x, y=y)) +
geom_point()
female_df
# load relevant libraries
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
## female depleted transcripts lollipop plots
## create a data frame with female_tissue and the corresponding no. of depleted transcripts
female_df <- data.frame(
x = c("female_brain", "female_heart", "female_liver", "female_lung", "female_muscle", "female_placenta"),
y = c(443, 19, 444, 75, 32, 208)
) %>%
arrange(desc(y))
View(female_df)
## plot
ggplot(female_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw()
# load relevant libraries
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
## female depleted transcripts lollipop plots
## create a data frame with female_tissue and the corresponding no. of depleted transcripts
female_df <- data.frame(
x = c("female_liver", "female_brain", "female_placenta", "female_lung", "female_muscle", "female_heart"),
y = c(444, 443, 208, 75, 32, 19)
)
## plot
ggplot(female_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw()
female_df$x <- factor(female_df$x, levels = female_df$x)
## plot
ggplot(female_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw() +
xlab("Tissue") +
ylab("Number of Transcripts")
male_df <- data.frame(
x = c("male_brain", "male_heart", "male_liver", "male_lung", "male_muscle", "male_placenta"),
y = c(184, 26, 383, 677, 39, 135)
) %>%
arrange(desc(y))
## sets the levels of 'x' in the order they appear in the df
male_df$x <- factor(male_df$x, levels = male_df$x)
## plot
ggplot(male_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw() +
xlab("Tissue") +
ylab("Number of Transcripts")
## male depleted transcripts lollipop plots
## create a data frame with male_tissue and the corresponding no. of depleted transcripts
male_df <- data.frame(
x = c("Male Brain", "male_heart", "male_liver", "male_lung", "male_muscle", "male_placenta"),
y = c(184, 26, 383, 677, 39, 135)
) %>%
arrange(desc(y))
## sets the levels of 'x' in the order they appear in the df
male_df$x <- factor(male_df$x, levels = male_df$x)
## plot
ggplot(male_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw() +
xlab("Tissue") +
ylab("Number of Transcripts")
# load relevant libraries
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/tissue_depletion/rawData"
## female depleted transcripts lollipop plots
## create a data frame with female_tissue and the corresponding no. of depleted transcripts
female_df <- data.frame(
x = c("Female Brain", "Female Heart", "Female Liver", "Female Lung", "Female Muscle", "Female Placenta"),
y = c(443, 19, 444, 75, 32, 208)
) %>%
arrange(desc(y))
## sets the levels of 'x' in the order they appear in the df
female_df$x <- factor(female_df$x, levels = female_df$x)
## plot
ggplot(female_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw() +
xlab("Tissue") +
ylab("Number of Transcripts")
## male depleted transcripts lollipop plots
## create a data frame with male_tissue and the corresponding no. of depleted transcripts
male_df <- data.frame(
x = c("Male Brain", "Male Heart", "Male Liver", "Male Lung", "Male Muscle", "Male Placenta"),
y = c(184, 26, 383, 677, 39, 135)
) %>%
arrange(desc(y))
## sets the levels of 'x' in the order they appear in the df
male_df$x <- factor(male_df$x, levels = male_df$x)
## plot
ggplot(male_df,
aes(x=x, y=y)) +
geom_point() +
geom_segment(aes(x = x, xend = x, y = 0, yend = y)) +
theme_bw() +
xlab("Tissue") +
ylab("Number of Transcripts")
