library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/sexSpecific_comparison/rawData"
import_placentaF_depleted <- file.path(projectDir, "placenta_female_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "placenta_male_depleted_annotated.csv")
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
View(placentaF_depleted)
View(placentaM_depleted)
library(gprofiler2)
# order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
head(placentaF_ordered_enriched$result, 50)
# make a 'publishable plot with top 4 enriched genes highlighted
placentaF_enriched_plot <- gostplot(placentaF_ordered_enriched, interactive = FALSE)
publish_gostplot(placentaF_enriched_plot, highlight_terms = c("	GO:0141052", "GO:0032452", "GO:0140457", "GO:0032451"))
publish_gostplot(placentaF_enriched_plot, highlight_terms = c("GO:0141052", "GO:0032452", "GO:0140457", "GO:0032451"))
# order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
head(placentaM_ordered_enriched$result, 50)
# male placenta plot
placentaM_enriched_plot <- gostplot(placentaM_ordered_enriched, interactive = FALSE)
publish_gostplot(placentaM_enriched_plot)
publish_gostplot(placentaM_enriched_plot, highlight_terms = c("GO:0008397", "GO:0033778", "GO:0007155", "GO:0033779"))
# male placenta plot
placentaM_enriched_plot <- gostplot(placentaM_ordered_enriched, interactive = FALSE)
# male placenta plot
placentaM_enriched_plot <- gostplot(placentaM_ordered_enriched, interactive = FALSE)
publish_gostplot(placentaM_enriched_plot, highlight_terms = c("GO:0008397", "GO:0033778", "GO:0007155", "GO:0033779"))
publish_gostplot(placentaF_enriched_plot, highlight_terms = c("GO:0141052", "GO:0032452", "GO:0140457", "GO:0032451"))
publish_gostplot(placentaM_enriched_plot, highlight_terms = c("GO:0008397", "GO:0033778", "GO:0007155", "GO:0033779"))
# female enriched GO terms export
## make placentaF_ordered_enriched$result a df
placentaF_enriched_export <- placentaF_ordered_enriched$result %>%
as.data.frame()
## remove list column - parents
placentaF_enriched_export <- placentaF_enriched_export[,-14]
## export as a cvs
write.csv(placentaF_enriched_export, file = file.path(projectDir, "placentaF_sexComparison_enrichedPathways.csv"))
# male enriched GO terms export
## make placentaF_ordered_enriched$result a df
placentaM_enriched_export <- placentaM_ordered_enriched$result %>%
as.data.frame()
## remove list column - parents
placentaM_enriched_export <- placentaM_enriched_export[,-14]
## export as a cvs
write.csv(placentaM_enriched_export, file = file.path(projectDir, "placentaM_sexComparison_enrichedPathways.csv"))
