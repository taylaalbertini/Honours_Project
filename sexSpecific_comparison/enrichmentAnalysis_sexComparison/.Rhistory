library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/sexSpecific_comparison/rawData"
import_placentaF_depleted <- file.path(projectDir, "placenta_female_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "placenta_male_depleted_annotated.csv")
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
View(placentaF_depleted)
View(placentaM_depleted)
library(gprofiler2)
# order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
head(placentaF_ordered_enriched$result, 50)
# make a 'publishable plot with top 4 enriched genes highlighted
placentaF_enriched_plot <- gostplot(placentaF_ordered_enriched, interactive = FALSE)
publish_gostplot(placentaF_enriched_plot, highlight_terms = c("	GO:0141052", "GO:0032452", "GO:0140457", "GO:0032451"))
publish_gostplot(placentaF_enriched_plot, highlight_terms = c("GO:0141052", "GO:0032452", "GO:0140457", "GO:0032451"))
# order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
head(placentaM_ordered_enriched$result, 50)
# male placenta plot
placentaM_enriched_plot <- gostplot(placentaM_ordered_enriched, interactive = FALSE)
publish_gostplot(placentaM_enriched_plot)
publish_gostplot(placentaM_enriched_plot, highlight_terms = c("GO:0008397", "GO:0033778", "GO:0007155", "GO:0033779"))
# male placenta plot
placentaM_enriched_plot <- gostplot(placentaM_ordered_enriched, interactive = FALSE)
# male placenta plot
placentaM_enriched_plot <- gostplot(placentaM_ordered_enriched, interactive = FALSE)
publish_gostplot(placentaM_enriched_plot, highlight_terms = c("GO:0008397", "GO:0033778", "GO:0007155", "GO:0033779"))
publish_gostplot(placentaF_enriched_plot, highlight_terms = c("GO:0141052", "GO:0032452", "GO:0140457", "GO:0032451"))
publish_gostplot(placentaM_enriched_plot, highlight_terms = c("GO:0008397", "GO:0033778", "GO:0007155", "GO:0033779"))
# female enriched GO terms export
## make placentaF_ordered_enriched$result a df
placentaF_enriched_export <- placentaF_ordered_enriched$result %>%
as.data.frame()
## remove list column - parents
placentaF_enriched_export <- placentaF_enriched_export[,-14]
## export as a cvs
write.csv(placentaF_enriched_export, file = file.path(projectDir, "placentaF_sexComparison_enrichedPathways.csv"))
# male enriched GO terms export
## make placentaF_ordered_enriched$result a df
placentaM_enriched_export <- placentaM_ordered_enriched$result %>%
as.data.frame()
## remove list column - parents
placentaM_enriched_export <- placentaM_enriched_export[,-14]
## export as a cvs
write.csv(placentaM_enriched_export, file = file.path(projectDir, "placentaM_sexComparison_enrichedPathways.csv"))
# Chunk 1
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/sexSpecific_comparison/rawData"
import_placentaF_depleted <- file.path(projectDir, "placenta_female_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "placenta_male_depleted_annotated.csv")
# Chunk 2
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
# install and laod library for gprofiler2
#BiocManager::install("gprofiler2")
library(gprofiler2)
# order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE,
evcodes = TRUE)
# order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE,
evcodes = TRUE)
View(placentaM_ordered_enriched)
placentaM_ordered_enriched[["result"]][["term_name"]]
View(placentaF_ordered_enriched)
placentaF_ordered_enriched[["result"]][["term_name"]]
#BiocManager::install("rrvgo")
library(rrvgo)
library(ComplexHeatmap)
# BP
## create similarity matrix for GO terms of BP source
simMatrix_BP <- calculateSimMatrix(placentaF_ordered_enriched$result$term_id,
orgdb = "org.Hs.eg.db",
ont = "BP",
method = "Rel")
# MF
## create similarity matrix for GO terms of MF source
simMatrix_MF <- calculateSimMatrix(placentaF_ordered_enriched$result$term_id,
orgdb = "org.Hs.eg.db",
ont = "MF",
method = "Rel")
## set scores
scores <- setNames(-log10(placentaF_ordered_enriched$result$p_value), placentaF_ordered_enriched$result$term_id)
## reduce the number of terms based on the similarity matrix for BP terms
reducedTerms_BP <- reduceSimMatrix(simMatrix_BP,
threshold = 0.85,
orgdb = "org.Hs.eg.db",
scores)
## reduce the number of terms based on the similarity matrix for MF terms
reducedTerms_MF <- reduceSimMatrix(simMatrix_MF,
threshold = 0.85,
orgdb = "org.Hs.eg.db",
scores)
## add the source to table
reducedTerms_MF$source <- "MF"
View(simMatrix_MF)
View(reducedTerms_MF)
# CC
## create similarity matrix for GO terms of CC source
simMatrix_CC <- calculateSimMatrix(placentaF_ordered_enriched$result$term_id,
orgdb = "org.Hs.eg.db",
ont = "CC",
method = "Rel")
## reduce the number of terms based on the similarity matrix for CC terms
reducedTerms_CC <- reduceSimMatrix(simMatrix_CC,
threshold = 0.85,
orgdb = "org.Hs.eg.db",
scores)
## export reduced GO terms for visualisation
write.csv(file = file.path("/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/enrichmentAnalysis_fetal.Rproj/raw_data/midF_sexspecific.csv"))
## export reduced GO terms for visualisation
write.csv(reducedTerms_MF, file = file.path("/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/enrichmentAnalysis_fetal.Rproj/raw_data/midF_sexspecific.csv"))
reducedTerms_termF <- read_delim("/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/enrichmentAnalysis_fetal.Rproj/raw_data/reducedTerms_termF_sexSpecific.csv",
col_names = TRUE,
delim = ",") %>%
dplyr::select(., -...1)
reducedTerms_termM <- read_delim("/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/enrichmentAnalysis_fetal.Rproj/raw_data/reducedTerms_termM_sexSpecific.csv",
col_names = TRUE,
delim = ",") %>%
dplyr::select(., -...1)
reducedTerms_midF <- read_delim(file = file.path("/Users/taylaalbertini/Desktop/R studio/honours_project/fetal_comparison/enrichmentAnalysis_fetal.Rproj/raw_data/midF_sexspecific.csv"),
col_names = TRUE,
delim = ",") %>%
dplyr::select(., -...1)
View(reducedTerms_midF)
View(reducedTerms_termF)
View(reducedTerms_termM)
reducedTerms_midF$tissue <- "Mid-gestation Placenta (Female)"
## add the source to table
reducedTerms_MF$source <- "MF"
reducedTerms_MF$source <- "MF"
reducedTerms_midF$source <- "MF"
reducedTerms_midF <- dplyr::select(reducedTerms_midF, parentTerm, size, source, tissue)
reducedTerms_termF$tissue <- "Term Placenta (Female)"
reducedTerms_termM$tissue <- "Term Placenta (Male)"
# rbind results
reducedTerms_combined <- rbind(reducedTerms_termF, reducedTerms_termM) %>%
rbind(., reducedTerms_midF) %>%
group_by(parentTerm, source) %>%
summarise(size = sum(size), .groups = 'drop')
View(reducedTerms_combined)
# rbind results
reducedTerms_combined <- rbind(reducedTerms_termF, reducedTerms_termM) %>%
rbind(., reducedTerms_midF) %>%
group_by(., parentTerm, source) %>%
summarise(., size = sum(size), .groups = 'drop')
View(reducedTerms_combined)
# rbind results
reducedTerms_combined <- rbind(reducedTerms_termF, reducedTerms_termM) %>%
rbind(., reducedTerms_midF)
# rbind results
reducedTerms_combined <- rbind(reducedTerms_termF, reducedTerms_termM) %>%
rbind(., reducedTerms_midF) %>%
group_by(., parentTerm, source, tissue) %>%
summarise(., size = sum(size), .groups = 'drop')
ggsave("sexspecific_go_point.png", width = 8.5, height = 7, units = "in")
# create a dot plot
reducedTerms_combined %>%
ggplot( aes(x=tissue, y=parentTerm, color = source, size = size)) +
geom_point(stat="identity", show.legend = TRUE) +
labs(x = "Tissue", y = "Parent GO Term", color = "Source", size = "Number of Associations") +
theme_bw() +
theme(text = element_text(size = 10)) +
scale_color_manual(values = c("#9ECAE1", "#E41A1C", "#B8E186"))
ggsave("sexspecific_go_point.png", width = 8.5, height = 7, units = "in")
ggsave("sexspecific_go_point.png", width = 7 height = 7, units = "in")
ggsave("sexspecific_go_point.png", width = 7, height = 7, units = "in")
ggsave("sexspecific_go_point.png", width = 8, height = 7, units = "in")
ggsave("sexspecific_go_point.png", width = 8.5, height = 8.5, units = "in")
View(reducedTerms_midF)
# Chunk 1
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/sexSpecific_comparison/rawData"
import_placentaF_depleted <- file.path(projectDir, "placenta_female_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "placenta_male_depleted_annotated.csv")
# Chunk 2
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# install and laod library for gprofiler2
#BiocManager::install("gprofiler2")
library(gprofiler2)
# order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE,
evcodes = TRUE)
# investigate which genes were enriched in fatty acid oxidation related GO terms
go_term_of_interest <- "histone demethylase activity"
enriched_row <- placentaM_ordered_enriched$result[placentaM_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
enriched_row <- placentaF_ordered_enriched$result[placentaF_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
# investigate which genes were enriched in fatty acid oxidation related GO terms
go_term_of_interest <- "protein demethylase activity"
enriched_row <- placentaF_ordered_enriched$result[placentaF_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
# investigate which genes were enriched in fatty acid oxidation related GO terms
go_term_of_interest <- "demethylase activity"
enriched_row <- placentaF_ordered_enriched$result[placentaF_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
# investigate which genes were enriched in fatty acid oxidation related GO terms
go_term_of_interest <- "2-oxoglutarate-dependent dioxygenase activity"
enriched_row <- placentaF_ordered_enriched$result[placentaF_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
library(gprofiler2)
library(forcats)
library(rrvgo)
library(ComplexHeatmap)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/term_sex_specific_analysis/rawData"
import_placentaF_depleted <- file.path(projectDir, "termF_placenta_depleted_annotated.csv")
import_placnetaM_depleted <- file.path(projectDir, "termM_placenta_depleted_annotated.csv")
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
## tidy placentaF_depleted - remove the "...1" column
dplyr::select(., -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placnetaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
## tidy placentaM_depleted - remove the "...1" column
dplyr::select(., -...1)
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE,
evcodes = TRUE)
View(placentaF_ordered_enriched)
# investigate which genes were enriched in histone demethylase activity related GO terms
go_term_of_interest <- "histone demethylase activity"
enriched_row <- placentaF_ordered_enriched$result[placentaF_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
## reduce terms
library(rrvgo)
library(ComplexHeatmap)
# MF
## create similarity matrix for GO terms of MF source
simMatrix_MF <- calculateSimMatrix(placentaF_ordered_enriched$result$term_id,
orgdb = "org.Hs.eg.db",
ont = "MF",
method = "Rel")
## set scores
scores <- setNames(-log10(placentaF_ordered_enriched$result$p_value), placentaF_ordered_enriched$result$term_id)
## reduce the number of terms based on the similarity matrix for MF terms
reducedTerms_MF <- reduceSimMatrix(simMatrix_MF,
threshold = 0.85,
orgdb = "org.Hs.eg.db",
scores)
View(reducedTerms_MF)
# investigate which genes were enriched in histone demethylase activity related GO terms
go_term_of_interest <- "protein demethylase activity"
enriched_row <- placentaF_ordered_enriched$result[placentaF_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
# investigate which genes were enriched in histone demethylase activity related GO terms
go_term_of_interest <- "demethylase activity"
enriched_row <- placentaF_ordered_enriched$result[placentaF_ordered_enriched$result$term_name == go_term_of_interest, ]
print(enriched_row$intersection)
