column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
show_name = FALSE,
border = "black",
bottom_annotation = column_earlyM_ha,
col = color_mapping)
## create heatmap with annotation
heatmap_earlyM <- Heatmap(log10(earlyM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
bottom_annotation = column_earlyM_ha,
col = color_mapping)
heatmap_earlyM
## earlyM
## craete box plot annotation
column_earlyM_ha <- HeatmapAnnotation(
`log10 (nCPMs)` = anno_boxplot(
log10(earlyM_mat),
which = c("column"),
height = unit(4, "cm")),
show_legend = FALSE)
## create heatmap with annotation
heatmap_earlyM <- Heatmap(log10(earlyM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
bottom_annotation = column_earlyM_ha,
col = color_mapping)
heatmap_earlyM
## create heatmap with annotation
heatmap_earlyM <- Heatmap(log10(earlyM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_earlyM_ha,
col = color_mapping)
heatmap_earlyM
## create heatmap with annotation
heatmap_earlyM <- Heatmap(log10(earlyM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
bottom_annotation = column_earlyM_ha,
col = color_mapping)
heatmap_earlyM
## create heatmap with annotation
heatmap_earlyM <- Heatmap(log10(earlyM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_earlyM_ha,
col = color_mapping)
heatmap_earlyM
## earlyM
## craete box plot annotation
column_earlyM_ha <- HeatmapAnnotation(
`log10 (nCPMs)` = anno_boxplot(
log10(earlyM_mat),
which = c("column"),
height = unit(4, "cm")),
show_annotation_name = FALSE)
## create heatmap with annotation
heatmap_earlyM <- Heatmap(log10(earlyM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_earlyM_ha,
col = color_mapping)
heatmap_earlyM
## create heatmap with annotation
heatmap_earlyM <- Heatmap(log10(earlyM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_earlyM_ha,
col = color_mapping)
heatmap_earlyM
## earlyM
## craete box plot annotation
column_midF_ha <- HeatmapAnnotation(
`log10 (nCPMs)` = anno_boxplot(
log10(midF_mat),
which = c("column"),
height = unit(4, "cm")),
show_annotation_name = FALSE)
## create heatmap with annotation
heatmap_midF <- Heatmap(log10(midF_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_midF_ha,
col = color_mapping)
heatmap_midF
## midM
## craete box plot annotation
column_midM_ha <- HeatmapAnnotation(
`log10 (nCPMs)` = anno_boxplot(
log10(midM_mat),
which = c("column"),
height = unit(4, "cm")),
show_annotation_name = FALSE)
## create heatmap with annotation
heatmap_midF <- Heatmap(log10(midM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_midM_ha,
col = color_mapping)
## midF
## craete box plot annotation
column_midF_ha <- HeatmapAnnotation(
`log10 (nCPMs)` = anno_boxplot(
log10(midF_mat),
which = c("column"),
height = unit(4, "cm")),
show_annotation_name = FALSE)
## create heatmap with annotation
heatmap_midF <- Heatmap(log10(midF_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_midF_ha,
col = color_mapping)
## create heatmap with annotation
heatmap_midM <- Heatmap(log10(midM_mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
border = "black",
show_heatmap_legend = FALSE,
bottom_annotation = column_midM_ha,
col = color_mapping)
heatmap_midM
heatmap_midF
heatmap_midM
# print heatmaps
heatmap_earlyF + heatmap_earlyM + heatmap_midF + heatmap_midM
# print heatmaps
(heatmap_earlyF) + (heatmap_earlyM) + (heatmap_midF) +(heatmap_midM)
(heatmap_earlyF) + (heatmap_earlyM) + (heatmap_midF) +(heatmap_midM)
# save the plots
# export heatmap as jpeg
path_save <- "/Users/taylaalbertini/Desktop/ASMR_earlyF_depleted_heatmap.jpeg"
jpeg(path_save, width = 4000, height = 3500, res = 400)
draw(heatmap_earlyF)
dev.off()
# save the plots
# export heatmap as jpeg
path_save <- "/Users/taylaalbertini/Desktop/ASMR_earlyM_depleted_heatmap.jpeg"
jpeg(path_save, width = 4000, height = 3500, res = 400)
draw(heatmap_earlyM)
dev.off()
# save the plots
# export heatmap as jpeg
path_save <- "/Users/taylaalbertini/Desktop/ASMR_midM_depleted_heatmap.jpeg"
jpeg(path_save, width = 4000, height = 3500, res = 400)
draw(heatmap_midM)
dev.off()
# save the plots
# export heatmap as jpeg
path_save <- "/Users/taylaalbertini/Desktop/ASMR_midF_depleted_heatmap.jpeg"
jpeg(path_save, width = 4000, height = 3500, res = 400)
draw(heatmap_midF)
dev.off()
# Chunk 1
# load relevant libraries
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/oxygen_threshold/rawData"
# set path for data tables
import_earlyF_depleted <- file.path(projectDir, "earlyF_depleted.csv")
import_meanF_ncpms <- file.path(projectDir, "mean_female_cpms_oxy_TMM.csv")
# Chunk 2
# import female placenta depleted transcript table
placentaF_depleted <- read_delim(file = import_earlyF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
## remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# import ncpms of all female tissues
ncpms_female <- read_delim(file = import_meanF_ncpms,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
## remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# transform ncpm table so that 'ensembl' are rownames and sex_tissue are columns with ncpms
ncpms_female_2 <- t(ncpms_female) %>%
data.frame() %>%
tibble::rownames_to_column("ensembl")
# tidy table
## remove placenta counts
ncpms_female_2 <- ncpms_female_2[,-2]
## rename column names
colnames(ncpms_female_2) <- gsub("X2", "Mid-gestation Placenta (Female)", colnames(ncpms_female_2))
## remove sex_tissue row
ncpms_female_2 <- ncpms_female_2[-1,]
# subset placentaF_depleted to only include ncpms_TMM for placenta and corresponding ensembl IDs
depleted_placentaF <- dplyr::select(placentaF_depleted, ensembl, nCPM_early_placenta_TMM)
# left join ncpms_female_2 to depleted_placentaF
heat_plot <- dplyr::left_join(depleted_placentaF, ncpms_female_2, by = join_by(ensembl))
# tidy
## replace placenta colname
colnames(heat_plot) <- gsub("nCPM_early_placenta_TMM", "Early-gestation Placenta (Female)", colnames(heat_plot))
## put ncpms in descending order
heat_plot_ordered <- heat_plot[order(heat_plot$`Early-gestation Placenta (Female)`, decreasing = TRUE),]
## make heat_plot_ordered numeric
heat_plot_ordered$`Mid-gestation Placenta (Female)` <- as.numeric(heat_plot_ordered$`Mid-gestation Placenta (Female)`)
## change order so that placenta is last
heat_plot_ordered <- dplyr::relocate(heat_plot_ordered, `Early-gestation Placenta (Female)`, .after = `Mid-gestation Placenta (Female)`)
rownames(heat_plot_ordered) <- NULL
pheat_plot <- tibble::column_to_rownames(heat_plot_ordered, var = "ensembl")
write.csv(pheat_plot, file = file.path("/Users/taylaalbertini/Desktop/R studio/honours_project/libsize/earlyF_pheat.csv"))
# complex heatmap
library(ComplexHeatmap)
library(circlize)
library(grid)
# Heatmap function to visualise the matrix as a heatmap with default settings
## make my df a matrix
class(pheat_plot)
mat <- as.matrix(pheat_plot)
## column splot
column_split_vector <- c(rep("Group 1", 1), "Group 2")
## craete box plot annotation
column_ha <- HeatmapAnnotation(`log10 (nCPMs)` = anno_boxplot(log10(mat), which = c("column"), height = unit(4, "cm")))
## set the colour for the range -4 to 4
color_mapping <- colorRamp2(c(-1, 0, 4), c("blue", "white", "red"))
## print heatmap with annotation
heatmapF <- Heatmap(log10(mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_rot = 45,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
name = "log10 (nCPM)",
border = "black",
bottom_annotation = column_ha,
col = color_mapping)
heatmapF
## set the colour for the range -4 to 4
color_mapping <- colorRamp2(c(-1, 1, 4), c("blue", "white", "red"))
## print heatmap with annotation
heatmapF <- Heatmap(log10(mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_rot = 45,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
name = "log10 (nCPM)",
border = "black",
bottom_annotation = column_ha,
col = color_mapping)
heatmapF
# export heatmap as jpeg
path_save <- "/Users/taylaalbertini/Desktop/earlyF_depleted_heatmap.jpeg"
jpeg(path_save, width = 4000, height = 3500, res = 400)
draw(heatmapF)
dev.off()
# Chunk 1
# load relevant libraries
library(plyr)
library(reshape2)
library(dplyr)
library(stringr)
library(readxl)
library(readr)
library(magrittr)
library(ggplot2)
library(edgeR)
library(limma)
library(Glimma)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/oxygen_threshold/rawData"
# set path for data tables
import_placentaM_depleted <- file.path(projectDir, "earlyM_depleted.csv")
import_meanM_ncpms <- file.path(projectDir, "mean_male_cpms_oxy_TMM.csv")
# Chunk 2
# import male placenta depleted transcript table
placentaM_depleted <- read_delim(file = import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
## remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# import ncpms of all male tissues
ncpms_male <- read_delim(file = import_meanM_ncpms,
col_names = TRUE,
delim = ",") %>%
as.data.frame() %>%
## remove the first column "...1" that;s input when the file is imported
dplyr::select(., -...1)
# transform the ncpms table so that 'ensembl' are rownames and sex_tissue are columns with ncpms
ncpms_male_2 <- t(ncpms_male) %>%
data.frame() %>%
tibble::rownames_to_column("ensembl")
# tidy table
## remove placenta counts
ncpms_male_2 <- ncpms_male_2[,-2]
## rename column names
colnames(ncpms_male_2) <- gsub("X2", "Mid-gestation Placenta (Male)", colnames(ncpms_male_2))
## remove sex_tissue row
ncpms_male_2 <- ncpms_male_2[-1,]
# subset placentaF_depleted to only include ncpms_TMM for placenta and corresponding ensembl IDs
depleted_placentaM <- dplyr::select(placentaM_depleted, ensembl, nCPM_early_placenta_TMM)
# left join ncpms_male_2 to depleted_placentaM
heat_plot <- dplyr::left_join(depleted_placentaM, ncpms_male_2, by = join_by(ensembl))
# tidy
## replace placenta colname
colnames(heat_plot) <- gsub("nCPM_early_placenta_TMM", "Early-gestation Placenta (Male)", colnames(heat_plot))
## put ncpms in descending order
heat_plot_ordered <- heat_plot[order(heat_plot$`Early-gestation Placenta (Male)`, decreasing = TRUE),]
## make heat_plot_ordered numeric
heat_plot_ordered$`Mid-gestation Placenta (Male)` <- as.numeric(heat_plot_ordered$`Mid-gestation Placenta (Male)`)
## change order so that placenta is last
heat_plot_ordered <- dplyr::relocate(heat_plot_ordered, `Early-gestation Placenta (Male)`, .after = `Mid-gestation Placenta (Male)`)
rownames(heat_plot_ordered) <- NULL
pheat_plot <- tibble::column_to_rownames(heat_plot_ordered, var = "ensembl")
# complex heatmap
library(ComplexHeatmap)
# Heatmap function to visualise the matrix as a heatmap with default settings
## make my df a matrix
class(pheat_plot)
mat <- as.matrix(pheat_plot)
class(mat)
write.csv(pheat_plot, file = file.path("/Users/taylaalbertini/Desktop/R studio/honours_project/libsize/earlyM_pheat.csv"))
## column splot
column_split_vector <- c(rep("Group 1", 1), "Group 2")
## craete box plot annotation
column_ha <- HeatmapAnnotation(`log10 (nCPMs)` = anno_boxplot(log10(mat), which = c("column"), height = unit(4, "cm")))
## set colour mapping for range -4 to 4
color_mapping <- colorRamp2(c(-1, 0, 3), c("blue", "white", "red"))
## print heatmap with annotation
heatmapM = Heatmap(log10(mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_rot = 45,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
name = "log10 (nCPM)",
border = "black",
bottom_annotation = column_ha,
col = color_mapping)
heatmapM
## set colour mapping for range -4 to 4
color_mapping <- colorRamp2(c(-1, 1, 3), c("blue", "white", "red"))
## print heatmap with annotation
heatmapM = Heatmap(log10(mat),
column_split = column_split_vector,
column_title = "Tissues",
column_title_gp = gpar(fontsize = 12),
column_title_side = c("bottom"),
row_title = "Genes",
row_title_gp = gpar(fontsize = 12),
show_row_names = FALSE,
column_names_rot = 45,
column_names_gp = gpar(fontsize = 10),
cluster_rows = FALSE,
cluster_columns = FALSE,
width = unit(2, "cm"),
name = "log10 (nCPM)",
border = "black",
bottom_annotation = column_ha,
col = color_mapping)
heatmapM
# export heatmap as jpeg
path_save <- "/Users/taylaalbertini/Desktop/earlyM_depleted_heatmap_updated.jpeg"
jpeg(path_save, width = 4000, height = 3500, res = 400)
draw(heatmapM)
dev.off()
