placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# install and laod library for gprofiler2
library(gprofiler2)
# female placenta enrichment analysis
## order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## visualise the GO terms
head(placentaF_ordered_enriched$result, 50)
# male placenta enrichment analysis
## order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## visualise the GO terms
head(placentaM_ordered_enriched$result, 50)
# load simplifyEnrichment package
library(simplifyEnrichment)
library(org.Hs.eg.db)
library(Cairo)
# semantic reduction of male GO terms
## craete a similarity matrix of the GO terms
### make a vector of GO IDs
go_id_vectorM <- placentaM_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixM <- GO_similarity(go_id_vectorM,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedM <- simplifyGO(mat = go_id_similarityMatrixM,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "GO terms",
verbose = TRUE)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/oxygen_threshold/rawData"
import_placentaF_depleted <- file.path(projectDir, "mid_placentaF_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "mid_placentaM_depleted_annotated.csv")
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# convert ensembl IDs into entrez IDs
## install and load libraries neede for conversion
BiocManager::install("org.Hs.eg.db")
library(org.Hs.eg.db)
library(AnnotationDbi)
## perform conversion
### convert ensembl to rownames
placentaF_entrez <- tibble::column_to_rownames(placentaF_depleted, var = "ensembl")
entrez_ids <- mapIds(org.Hs.eg.db, keys = rownames(placentaF_entrez), keytype="ENSEMBL", column = "ENTREZID") %>%
as.data.frame()
### change colname from "." to ENTREZID
colnames(entrez_ids) <- gsub(".", "ENTREZID", colnames(entrez_ids))
### create a vector consisting of just the entrez ids
entrez_vector <- entrez_ids$ENTREZID
# perform functonal enrichment analysis using the tool enrichKEGG
## install clusterProfiler package which has enrichKEGG tool/function
library("clusterProfiler")
## run enrichKEGG function on entrez IDs
kegg_result <- enrichKEGG(entrez_vector,
organism = "hsa",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "BH",
minGSSize = 10,
maxGSSize = 500,
qvalueCutoff = 0.2,
use_internal_data = FALSE)
print(kegg_result)
head(kegg_result, 21)
# convert ensembl IDs into entrez IDs
## install and load libraries neede for conversion
library(org.Hs.eg.db)
library(AnnotationDbi)
## perform conversion
### convert ensembl to rownames
placentaM_entrez <- tibble::column_to_rownames(placentaM_depleted, var = "ensembl")
entrezM_ids <- mapIds(org.Hs.eg.db, keys = rownames(placentaM_entrez), keytype="ENSEMBL", column = "ENTREZID") %>%
as.data.frame()
### change colname from "." to ENTREZID
colnames(entrezM_ids) <- gsub(".", "ENTREZID", colnames(entrezM_ids))
### create a vector consisting of just the entrez ids
entrezM_vector <- entrezM_ids$ENTREZID
# perform functonal enrichment analysis using the tool enrichKEGG
## install clusterProfiler package which has enrichKEGG tool/function
library(clusterProfiler)
## run enrichKEGG function on entrez IDs
kegg_result <- enrichKEGG(entrezM_vector,
organism = "hsa",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "BH",
minGSSize = 10,
maxGSSize = 500,
qvalueCutoff = 0.2,
use_internal_data = FALSE)
print(kegg_result)
head(kegg_result, 21)
# install and laod library for gprofiler2
library(gprofiler2)
# female placenta enrichment analysis
## order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## view the GO terms
head(placentaF_ordered_enriched$result, 50)
# male placenta enrichment analysis
## order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## view the GO terms
head(placentaM_ordered_enriched$result, 50)
# load simplifyEnrichment package
library(simplifyEnrichment)
library(org.Hs.eg.db)
library(Cairo)
# semantic reduction of female GO terms
## craete a similarity matrix of the GO terms
### make a vector of GO IDs
go_id_vectorF <- placentaF_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixF <- GO_similarity(go_id_vectorF,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedF <- simplifyGO(mat = go_id_similarityMatrixF,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "Female placenta depleted GO term semantic reduction",
verbose = TRUE)
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/oxygen_threshold/rawData"
import_placentaF_depleted <- file.path(projectDir, "early_placentaF_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "early_placentaM_depleted_annotated.csv")
# install ggkegg, scatterpie and tidygraph packages if don't already have
# load libraries
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# install and laod library for gprofiler2
library(gprofiler2)
# female placenta enrichment analysis
## order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## visualise the GO terms
head(placentaF_ordered_enriched$result, 50)
# male placenta enrichment analysis
## order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## visualise the GO terms
head(placentaM_ordered_enriched$result, 50)
library(simplifyEnrichment)
library(org.Hs.eg.db)
library(Cairo)
# semantic reduction of female GO terms
## craete a similarity matrix of the GO terms
### make a vector of GO IDs
go_id_vectorF <- placentaF_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixF <- GO_similarity(go_id_vectorF,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedF <- simplifyGO(mat = go_id_similarityMatrixF,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "Female placenta depleted GO term semantic reduction",
verbose = TRUE)
go_id_vectorM <- placentaM_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixM <- GO_similarity(go_id_vectorM,
ont = "ont",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
# semantic reduction of male GO terms
## craete a similarity matrix of the GO terms
### make a vector of GO IDs
go_id_vectorM <- placentaM_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixM <- GO_similarity(go_id_vectorM,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedM <- simplifyGO(mat = go_id_similarityMatrixM,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "Male early-gestation placenta depleted GO term semantic reduction",
verbose = TRUE)
View(placentaF_ordered_enriched)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedM <- simplifyGO(mat = go_id_similarityMatrixM,
method = "binary_cut",
control = list(),
plot = TRUE,
word_cloud_grob_param = list(max_width = 80),
column_title = "Male early-gestation placenta depleted GO term semantic reduction",
verbose = TRUE)
str(go_id_simplifiedM)
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
library(gprofiler2)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/termPlacenta_comparison/rawData"
import_placentaF_depleted <- file.path(projectDir, "term_placentaF_depleted_annotated.csv")
import_placnetaM_depleted <- file.path(projectDir, "term_placentaM_depleted_annotated.csv")
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placnetaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# female placenta enrichment analysis
## order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
head(placentaF_ordered_enriched$result, 100)
# male placenta enrichment analysis
placentaM_enriched <- gost(placentaM_depleted$ensembl, organism = "hsapiens")
head(placentaM_enriched$result)
# order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
# perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
head(placentaM_ordered_enriched$result, 50)
library(simplifyEnrichment)
library(org.Hs.eg.db)
library(Cairo)
# semantic reduction of female GO terms
## craete a similarity matrix of the GO terms
### make a vector of GO IDs
go_id_vectorF <- placentaF_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixF <- GO_similarity(go_id_vectorF,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedF <- simplifyGO(mat = go_id_similarityMatrixF,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "Female term placenta depleted GO term semantic reduction",
verbose = TRUE)
go_id_vectorM <- placentaM_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixM <- GO_similarity(go_id_vectorM,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedM <- simplifyGO(mat = go_id_similarityMatrixM,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "Male term placenta depleted GO term semantic reduction",
verbose = TRUE)
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/oxygen_threshold/rawData"
import_placentaF_depleted <- file.path(projectDir, "early_placentaF_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "early_placentaM_depleted_annotated.csv")
# install ggkegg, scatterpie and tidygraph packages if don't already have
# load libraries
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# install and laod library for gprofiler2
library(gprofiler2)
# female placenta enrichment analysis
## order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## visualise the GO terms
head(placentaF_ordered_enriched$result, 50)
# male placenta enrichment analysis
## order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## visualise the GO terms
head(placentaM_ordered_enriched$result, 50)
library(simplifyEnrichment)
library(org.Hs.eg.db)
library(Cairo)
# semantic reduction of female GO terms
## craete a similarity matrix of the GO terms
### make a vector of GO IDs
go_id_vectorF <- placentaF_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixF <- GO_similarity(go_id_vectorF,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedF <- simplifyGO(mat = go_id_similarityMatrixF,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "Female early-gestation placenta depleted GO terms",
verbose = TRUE)
go_id_vectorM <- placentaM_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixM <- GO_similarity(go_id_vectorM,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedM <- simplifyGO(mat = go_id_similarityMatrixM,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "Male early-gestation placenta depleted GO term semantic reduction",
verbose = TRUE)
library(ggkegg)
library(tidygraph)
library(scatterpie)
library(dplyr)
library(readxl)
library(readr)
library(edgeR)
library(limma)
library(Glimma)
library(clusterProfiler)
library(enrichplot)
library(stringr)
library(magrittr)
library(ggplot2)
library(RColorBrewer)
# set project directory
projectDir <- "/Users/taylaalbertini/Desktop/R studio/honours_project/oxygen_threshold/rawData"
import_placentaF_depleted <- file.path(projectDir, "mid_placentaF_depleted_annotated.csv")
import_placentaM_depleted <- file.path(projectDir, "mid_placentaM_depleted_annotated.csv")
# import placenta female depleted table and make it into a data frame
placentaF_depleted <- read_delim(import_placentaF_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaF_depleted - remove the "...1" column
placentaF_depleted <- dplyr::select(placentaF_depleted, -...1)
# import male placenta depleted table and make into a data frame
placentaM_depleted <- read_delim(import_placentaM_depleted,
col_names = TRUE,
delim = ",") %>%
as.data.frame()
## tidy placentaM_depleted - remove the "...1" column
placentaM_depleted <- dplyr::select(placentaM_depleted, -...1)
# install and laod library for gprofiler2
library(gprofiler2)
# female placenta enrichment analysis
## order genes by nCPM_ratio
placentaF_ordered <- placentaF_depleted[order(placentaF_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment analysis on ordered genes
placentaF_ordered_enriched <- gost(placentaF_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## view the GO terms
head(placentaF_ordered_enriched$result, 50)
# male placenta enrichment analysis
## order genes by nCPM_ratio
placentaM_ordered <- placentaM_depleted[order(placentaM_depleted$nCPM_ratio_TMM, decreasing = TRUE),]
## perform enrichment on ordered genes
placentaM_ordered_enriched <- gost(placentaM_ordered$ensembl, organism = "hsapiens",
ordered_query = TRUE)
## view the GO terms
head(placentaM_ordered_enriched$result, 50)
go_id_vectorM <- placentaM_ordered_enriched$result$term_id %>%
as.vector()
go_id_similarityMatrixM <- GO_similarity(go_id_vectorM,
ont = "BP",
db = "org.Hs.eg.db",
measure = "Rel",
remove_orphan_terms = FALSE)
## use the simplifyEnrichment tool to cluster the GO terms
go_id_simplifiedM <- simplifyGO(mat = go_id_similarityMatrixM,
method = "binary_cut",
control = list(),
plot = TRUE,
column_title = "GO terms",
verbose = TRUE)
